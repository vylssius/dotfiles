"use strict";(this.webpackChunk_dashlane_webcards=this.webpackChunk_dashlane_webcards||[]).push([[311],{1093:()=>{},1515:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChunkedChannel=void 0;var r=n(2844),s=n(8489);const a=e=>{if(!e.chunkId)throw new Error(`ChunkedMessage did not have a chunkId: ${JSON.stringify(e)}`)};class i extends r.GenericChannel{constructor(e){super(e.timeout),this._chunkSize=void 0,this._maxStringAlloc=void 0,this._sender=void 0,this._buffer={},this._chunkSize=e.chunkSize,this._sender=e.sender,this._maxStringAlloc=e.maxStringAlloc||-1}send(e){const t=JSON.stringify(e);if(t.length<=this._chunkSize)return void this._sender(e);const n=(e=>{const t=new Uint16Array(e.length);for(let n=0,r=e.length;n<r;n++)t[n]=e.charCodeAt(n);return t})(t),r=[...Array(30)].map((()=>Math.random().toString(36)[3])).join("");this._sender({type:"chunk_start",chunkId:r,size:t.length});const s=(e=0)=>{let t=n.slice(e,e+this._chunkSize);t.length&&(this._sender({type:"chunk_data",chunkId:r,data:Array.from(t)}),s(e+this._chunkSize))};s(),this._sender({type:"chunk_end",chunkId:r})}_messageReceived(e){switch(e.type){case"chunk_start":this._receiveNewChunk(e);break;case"chunk_data":this._receiveChunkData(e);break;case"chunk_end":const t=this._mergeChunks(e);super._messageReceived(t);break;default:super._messageReceived(e)}}_receiveNewChunk(e){if(a(e),this._buffer[e.chunkId])throw new Error(`There was already an entry in the buffer for chunkId ${e.chunkId}`);this._buffer[e.chunkId]={id:e.chunkId,chunks:[],size:e.size}}_receiveChunkData(e){if(a(e),!this._buffer[e.chunkId])throw new Error(`ChunkId ${e.chunkId} was not found in the buffer`);this._buffer[e.chunkId].chunks.push(e.data)}_mergeChunks(e){if(a(e),!this._buffer[e.chunkId])throw new Error(`ChunkId ${e.chunkId} was not found in the buffer`);const t=this._buffer[e.chunkId].chunks.reduce(((e,t,n)=>(t.forEach(((t,n)=>e.uintArray[e.currentIx+n]=t)),e.currentIx+=t.length,e)),{uintArray:new Uint16Array(this._buffer[e.chunkId].size),currentIx:0});let n;const r=((e,t)=>{if(-1===t)return String.fromCharCode.apply(null,e);{let n="";for(let r=0;r<e.length;r+=t)r+t>e.length?n+=String.fromCharCode.apply(null,e.subarray(r)):n+=String.fromCharCode.apply(null,e.subarray(r,r+t));return n}})(t.uintArray,this._maxStringAlloc);try{n=JSON.parse(r)}catch(e){throw new Error(`Not a valid JSON string: ${r}`)}if(!(0,s.isTransportMessage)(n))throw new Error(`Not a transport message: ${JSON.stringify(n)}`);return n}}t.ChunkedChannel=i},2844:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GenericChannel=void 0,t.GenericChannel=class{constructor(e=5e3){this._timeout=e,this._onMessageCallbacks=[],this._onConnectCallbacks=[],this._onDisconnectCallbacks=[],this._onErrorCallbacks=[],this._ready=!1}get timeout(){return this._timeout}onData(e){-1===this._onMessageCallbacks.indexOf(e)&&this._onMessageCallbacks.push(e)}onConnect(e){this._ready&&e(),this._onConnectCallbacks.push(e)}onDisconnect(e){this._onDisconnectCallbacks.push(e)}onError(e){this._onErrorCallbacks.push(e)}_messageReceived(e){this._onMessageCallbacks.forEach((t=>t(e)))}_error(e){this._onErrorCallbacks.forEach((t=>t(e)))}_connected(){this._ready=!0,this._onConnectCallbacks.forEach((e=>e()))}_disconnected(){this._ready=!1,this._onDisconnectCallbacks.forEach((e=>e()))}}},2374:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PARAM=void 0,t.DEFAULT_PARAM="$_DEFAULT_$"},8511:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.combineEvents=function(...e){const t=e.reduce(((e,t)=>(e.push.apply(e,Object.keys(t)),e)),[]),n=[...new Set(t)];if(t.length>n.length)throw new Error("ts-event-bus: duplicate slots encountered in combineEvents.");return Object.assign({},...e)},t.createEventBus=function(e){const t=(e.channels||[]).map((t=>new s.Transport(t,e.ignoredEvents))),n={};for(const s in e.events)e.events.hasOwnProperty(s)&&(!e.ignoredEvents||e.ignoredEvents&&!e.ignoredEvents.includes(s))&&(n[s]=(0,r.connectSlot)(s,t,e.events[s].config));return n};var r=n(4414),s=n(8346)},8557:(e,t)=>{function n(e,t){let n=null;try{n=e(t)}catch(e){return Promise.reject(e)}return n&&n.then?n:Promise.resolve(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.callHandlers=function(e,t){return t&&0!==t.length?1===t.length?n(t[0],e):Promise.all(t.map((t=>n(t,e)))):new Promise((e=>{}))}},8489:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isTransportMessage=function(e){switch(e.type){case"request":case"response":case"error":case"handler_unregistered":case"handler_registered":case"event_list":return!0;default:return!1}}},4414:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.slot=function(e=i){return o(e)},t.connectSlot=function(e,t,n={}){const a=t.reduce(((e,t,n)=>({...e,[n]:{}})),{[c]:{}}),i=t.reduce(((e,t,n)=>({...e,[n]:{}})),{}),o=(e,t)=>{let n=()=>{};const r=new Promise((e=>n=e));i[e][t]={registered:r,onRegister:n}},d=[],u=[],_=e=>d.forEach((t=>t(e))),f=e=>u.forEach((t=>t(e)));return t.forEach(((t,n)=>{t.addRemoteHandlerRegistrationCallback(e,((e=s.DEFAULT_PARAM,t)=>{if(!i[n])return;const r=a[n][e]||[];a[n][e]=r.concat(t),1===l(e,a).length&&_(e),i[n][e]||o(String(n),e),i[n][e].onRegister()})),t.addRemoteHandlerUnregistrationCallback(e,((e=s.DEFAULT_PARAM,t)=>{const r=(a[n][e]||[]).indexOf(t);r>-1&&a[n][e].splice(r,1),0===l(e,a).length&&f(e),i[n]&&o(String(n),e)})),t.addRemoteEventListChangedListener(e,(()=>{i[n]&&Object.keys(i[n]).forEach((e=>{i[n][e].onRegister()})),delete i[n]}))})),Object.assign((function(e,c){const h=2===arguments.length,d=h?c:e,u=h?e:s.DEFAULT_PARAM,_=()=>{const e=l(u,a);return(0,r.callHandlers)(d,e)};if(0===t.length)return _();const f=[];if(n.autoReconnect&&t.forEach((e=>{f.push(e.autoReconnect())})),n.noBuffer)return Promise.all(f).then((()=>_()));{t.forEach(((e,t)=>{i[t]&&!i[t][u]&&o(String(t),u)}));const e=t.reduce(((e,t,n)=>{var r;return[...e,...null!==(r=i[n]&&[i[n][u].registered])&&void 0!==r?r:[]]}),[]);return Promise.all(e).then((()=>_()))}}),{on:function(n,r){let i="",o=()=>new Promise((e=>e()));return"string"==typeof n?(i=n,o=r||o):(i=s.DEFAULT_PARAM,o=n),t.forEach((t=>t.registerHandler(e,i,o))),a[c][i]=(a[c][i]||[]).concat(o),1===l(i,a).length&&_(i),()=>{t.forEach((t=>t.unregisterHandler(e,i,o)));const n=(a[c][i]||[]).indexOf(o);-1!==n&&a[c][i].splice(n,1),0===l(i,a).length&&f(i)}},lazy:function(e,t){return d.push(e),u.push(t),h(a).forEach(e),()=>{h(a).forEach(t);const n=d.indexOf(e);n>-1&&d.splice(n,1);const r=u.indexOf(t);r>-1&&u.splice(r,1)}},config:n,slotName:e})},t.defaultSlotConfig=void 0;var r=n(8557),s=n(2374);const a=()=>{throw new Error("Slot not connected")},i={noBuffer:!1,autoReconnect:!0};t.defaultSlotConfig=i;const o=e=>Object.assign((()=>a()),{config:e,lazy:()=>a,on:()=>a,slotName:"Not connected"}),c="LOCAL_TRANSPORT",l=(e,t)=>Object.keys(t).reduce(((n,r)=>n.concat(t[r][e]||[])),[]),h=e=>Object.keys(e).reduce(((t,n)=>{const r=e[n],s=[...t,...Object.keys(r).filter((e=>(r[e]||[]).length>0))];return[...new Set(s)]}),[])},8346:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;var r=n(8557);let s=0;t.Transport=class{constructor(e,t){this._channel=e,this._localHandlers={},this._localHandlerRegistrations={},this._remoteHandlers={},this._remoteHandlerRegistrationCallbacks={},this._remoteHandlerDeletionCallbacks={},this._remoteIgnoredEventsCallbacks={},this._pendingRequests={},this._channelReady=!1,this._channel.onData((e=>{switch(e.type){case"request":return this._requestReceived(e);case"response":return this._responseReceived(e);case"handler_registered":return this._registerRemoteHandler(e);case"handler_unregistered":return this._unregisterRemoteHandler(e);case"error":return this._errorReceived(e);case"event_list":return this._remoteIgnoredEventsReceived(e);default:(e=>{throw new Error(`Should not happen: ${e}`)})(e)}})),this._channel.onConnect((()=>{this._channelReady=!0,Object.keys(this._localHandlerRegistrations).forEach((e=>{this._localHandlerRegistrations[e].forEach((e=>{this._channel.send(e)}))})),t&&this._channel.send({type:"event_list",ignoredEvents:t})})),this._channel.onDisconnect((()=>{this._channelReady=!1,this._unregisterAllRemoteHandlers(),this._rejectAllPendingRequests(new Error("REMOTE_CONNECTION_CLOSED"))})),this._channel.onError((e=>this._rejectAllPendingRequests(e)))}_remoteIgnoredEventsReceived({ignoredEvents:e}){Object.keys(this._remoteIgnoredEventsCallbacks).forEach((t=>{e.includes(t)&&this._remoteIgnoredEventsCallbacks[t]()}))}_requestReceived({slotName:e,data:t,id:n,param:s}){const a=this._localHandlers[e];if(!a)return;const i=a[s];i&&(0,r.callHandlers)(t,i).then((t=>this._channel.send({type:"response",slotName:e,id:n,data:t,param:s}))).catch((t=>this._channel.send({id:n,message:`${t}`,param:s,slotName:e,stack:t.stack||"",type:"error"})))}_responseReceived({slotName:e,data:t,id:n,param:r}){const s=this._pendingRequests[e];s&&s[r]&&s[r][n]&&(s[r][n].resolve(t),delete s[r][n])}_errorReceived({slotName:e,id:t,message:n,stack:r,param:s}){const a=this._pendingRequests[e];if(!a||!a[s]||!a[s][t])return;const i=new Error(`${n} on ${e} with param ${s}`);i.stack=r||i.stack,this._pendingRequests[e][s][t].reject(i),delete this._pendingRequests[e][s][t]}_registerRemoteHandler({slotName:e,param:t}){const n=this._remoteHandlerRegistrationCallbacks[e];if(!n)return;const r=this._remoteHandlers[e];if(r&&r[t])return;const a=n=>new Promise(((r,a)=>{if(!this._channelReady)return a(new Error(`CHANNEL_NOT_READY on ${e}`));const i=""+s++;this._pendingRequests[e]=this._pendingRequests[e]||{},this._pendingRequests[e][t]=this._pendingRequests[e][t]||{},this._pendingRequests[e][t][i]={resolve:r,reject:a},this._channel.send({type:"request",id:i,slotName:e,param:t,data:n}),setTimeout((()=>{const n=((this._pendingRequests[e]||{})[t]||{})[i];if(n){const r=new Error(`TIMED_OUT on ${e} with param ${t}`);n.reject(r),delete this._pendingRequests[e][t][i]}}),this._channel.timeout)}));this._remoteHandlers[e]=this._remoteHandlers[e]||{},this._remoteHandlers[e][t]=a,n(t,a)}_unregisterRemoteHandler({slotName:e,param:t}){const n=this._remoteHandlerDeletionCallbacks[e],r=this._remoteHandlers[e];if(!r)return;const s=r[t];s&&n&&(n(t,s),delete this._remoteHandlers[e][t])}_unregisterAllRemoteHandlers(){Object.keys(this._remoteHandlerDeletionCallbacks).forEach((e=>{const t=this._remoteHandlers[e];t&&Object.keys(t).filter((e=>t[e])).forEach((t=>this._unregisterRemoteHandler({slotName:e,param:t})))}))}_rejectAllPendingRequests(e){Object.keys(this._pendingRequests).forEach((t=>{Object.keys(this._pendingRequests[t]).forEach((n=>{Object.keys(this._pendingRequests[t][n]).forEach((r=>{this._pendingRequests[t][n][r].reject(e)}))})),this._pendingRequests[t]={}}))}addRemoteHandlerRegistrationCallback(e,t){this._remoteHandlerRegistrationCallbacks[e]||(this._remoteHandlerRegistrationCallbacks[e]=t)}addRemoteHandlerUnregistrationCallback(e,t){this._remoteHandlerDeletionCallbacks[e]||(this._remoteHandlerDeletionCallbacks[e]=t)}addRemoteEventListChangedListener(e,t){this._remoteIgnoredEventsCallbacks[e]||(this._remoteIgnoredEventsCallbacks[e]=t)}registerHandler(e,t,n){if(this._localHandlers[e]=this._localHandlers[e]||{},this._localHandlers[e][t]=this._localHandlers[e][t]||[],this._localHandlers[e][t].push(n),1===this._localHandlers[e][t].length){const n={type:"handler_registered",param:t,slotName:e};this._localHandlerRegistrations[t]=this._localHandlerRegistrations[t]||[],this._localHandlerRegistrations[t].push(n),this._channelReady&&this._channel.send(n)}}unregisterHandler(e,t,n){const r=this._localHandlers[e];if(r&&r[t]){const s=r[t].indexOf(n);if(s>-1&&(r[t].splice(s,1),0===r[t].length)){const n={type:"handler_unregistered",param:t,slotName:e};this._channelReady&&this._channel.send(n)}}}isDisconnected(){return!this._channelReady}autoReconnect(){if(this.isDisconnected()&&this._channel.autoReconnect){const e=new Promise((e=>{this._channel.onConnect((()=>e()))}));return this._channel.autoReconnect(),e}return Promise.resolve()}}},1796:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"slot",{enumerable:!0,get:function(){return r.slot}}),Object.defineProperty(t,"Slot",{enumerable:!0,get:function(){return r.Slot}}),Object.defineProperty(t,"EventDeclaration",{enumerable:!0,get:function(){return s.EventDeclaration}}),Object.defineProperty(t,"combineEvents",{enumerable:!0,get:function(){return s.combineEvents}}),Object.defineProperty(t,"createEventBus",{enumerable:!0,get:function(){return s.createEventBus}}),Object.defineProperty(t,"Channel",{enumerable:!0,get:function(){return a.Channel}}),Object.defineProperty(t,"GenericChannel",{enumerable:!0,get:function(){return i.GenericChannel}}),Object.defineProperty(t,"ChunkedChannel",{enumerable:!0,get:function(){return o.ChunkedChannel}}),Object.defineProperty(t,"TransportMessage",{enumerable:!0,get:function(){return c.TransportMessage}}),Object.defineProperty(t,"DEFAULT_PARAM",{enumerable:!0,get:function(){return l.DEFAULT_PARAM}});var r=n(4414),s=n(8511),a=n(1093),i=n(2844),o=n(1515),c=n(8489),l=n(2374)},415:(e,t)=>{function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("string"==typeof e[0]){for(var n={},r=0,s=e;r<s.length;r++){var a=s[r];n[a]=a}return n}return e[0]}Object.defineProperty(t,"__esModule",{value:!0}),t.Enum=n,function(e){function t(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];t.push(e[s])}return t}e.ofKeys=function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];t[s]=s}return t},e.keys=function(e){return Object.keys(e)},e.values=t,e.isType=function(e,n){return-1!==t(e).indexOf(n)}}(n=t.Enum||(t.Enum={}))}}]);